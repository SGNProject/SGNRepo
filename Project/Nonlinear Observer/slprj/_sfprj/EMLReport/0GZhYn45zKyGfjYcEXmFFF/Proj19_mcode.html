<pre class="code">
<span class="srcline"><span class="lineno"><a href="11,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">b_stim_dot</span>] = Proj(<span class="var type1" id="S3T3U6">b_stim</span>, <span class="var type1" id="S4T1U7">beta</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="11,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="11,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% M_b must be defined</span></span></span>
<span class="srcline"><span class="lineno"><a href="11,4" id="srcline4"> 4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="11,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%Parameter Projection function [11]</span></span></span>
<span class="srcline"><span class="lineno"><a href="11,6" id="srcline6"> 6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="11,7" id="srcline7"> 7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="11,8" id="srcline8"> 8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="11,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T3:U4"><span class="var type1" id="S5T3U10">zerovec</span> = <span class="mxinfo " id="T3:U6">zeros(<span class="mxinfo " id="T1:U7">size(<span class="var type1" id="S3T3U15">b_stim</span>,1)</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="11,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="11,11" id="srcline11">11</a></span><span class="line">    <span class="keyword">if</span> ((<span class="mxinfo " id="T1:U9">norm(<span class="var type1" id="S3T3U28">b_stim</span>)</span> &gt;= <span class="message error" id="M2F19C">M_b</span>) &amp;&amp; (<span class="mxinfo " id="T4:U11"><span class="mxinfo " id="T1:U12"><span class="mxinfo " id="T1:U13"><span class="var type1" id="S3T3U35">b_stim</span>(<span class="mxinfo " id="T6:U15">1</span>)</span>*<span class="var type1" id="S4T1U37">beta</span></span> &gt; <span class="mxinfo " id="T1:U17">0</span></span>) &amp;&amp; (<span class="mxinfo " id="T4:U18"><span class="mxinfo " id="T1:U19"><span class="mxinfo " id="T1:U20"><span class="var type1" id="S3T3U43">b_stim</span>(<span class="mxinfo " id="T6:U22">2</span>)</span>*<span class="var type1" id="S4T1U45">beta</span></span> &gt; <span class="mxinfo " id="T1:U24">0</span></span>) &amp;&amp; (<span class="mxinfo " id="T4:U25"><span class="mxinfo " id="T1:U26"><span class="mxinfo " id="T1:U27"><span class="var type1" id="S3T3U51">b_stim</span>(<span class="mxinfo " id="T6:U29">3</span>)</span>*<span class="var type1" id="S4T1U53">beta</span></span> &gt;<span class="mxinfo " id="T1:U31">0</span></span>))</span></span>
<span class="srcline"><span class="lineno"><a href="11,12" id="srcline12">12</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="11,13" id="srcline13">13</a></span><span class="line">        <span class="var type0" id="S2T0U57">b_stim_dot</span> = (<span class="mxinfo " id="T2:U32">eye(3)</span> - (<span class="message error" id="M3F19C"><span class="fcn" id="F40N4:B68">c</span>(<span class="var type1" id="S3T3U69">b_stim</span>)</span>*(<span class="var type0" id="S3T0U72">b_stim</span>*<span class="var type0" id="S3T0U74">b_stim</span>'))/norm(<span class="var type0" id="S3T0U78">b_stim</span>)^2)*<span class="var type0" id="S4T0U80">beta</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="11,14" id="srcline14">14</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="11,15" id="srcline15">15</a></span><span class="line">    <span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="11,16" id="srcline16">16</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="11,17" id="srcline17">17</a></span><span class="line">        <span class="mxinfo " id="T1:U34"><span class="var type1" id="S2T1U84">b_stim_dot</span> = <span class="var type1" id="S4T1U85">beta</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="11,18" id="srcline18">18</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="11,19" id="srcline19">19</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="11,20" id="srcline20">20</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="11,21" id="srcline21">21</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="11,22" id="srcline22">22</a></span><span class="line"></span></span>
</pre>
